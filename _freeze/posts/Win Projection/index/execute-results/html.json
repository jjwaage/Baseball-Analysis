{
  "hash": "1e525b8119fdc35608fdfd4b6edbc781",
  "result": {
    "markdown": "---\ntitle: \"Estimating Playoffs Based on the Previous Year's Data\"\nauthor: \"Jonna Waage\"\ndate: \"2023-05-31\"\n---\n\n\n## Can the MLB Playoff contending teams be estimated with last year's data?\n\n<!-- ::: callout-note -->\n<!-- Need a punchier question here. -->\n<!-- ::: -->\n\n\n\n\n\n### Introduction\n\n<!-- ::: callout-note -->\n<!-- You should switch to a more complete writing style for the introduction, rather than this bulleted list. This section should motivate the post by describing WHY it exists. It is literally ok to say it exists because we thought it was a good starting point for learning some of these tools. -->\n\n<!-- One writing framework to consider is called \"AND, BUT, THEREFORE.\" You have Fact1 AND Fact2, BUT there is a Constraint or Limitation or Problem. THEREFORE, this post exists. -->\n<!-- ::: -->\nThere are many different algorithms that try to simulate the next MLB season with extreme accuracy. The goal of this was to learn about this model and see how accurate a simulation can be with just a couple statistics taken into account.\n\nThis program simulates a 2023 season of all 162 games using the Bradley-Terry model. It uses last year's run differentials (average runs scored minus average runs allowed) to try to estimate this year's top performers.\n\n### Data\n\n<!-- ::: callout-note -->\n<!-- This section is good. You COULD add an explanatory sentence, but you don't need to. You might define the three things you create as data frames. -->\n<!-- ::: -->\n\n`schedule1 <- read_excel(\"schedule.xlsx\")` - reads in a two column excel sheet with headers 'Home' and 'Away' and teams from each game listed below\n\n`battingstats <- read_excel(\"2022battingstats.xlsx\")` - reads in a excel sheet with 2022 MLB batting statistics for all teams\n\n`fieldingstats <- read_excel(\"fieldingstats2022.xlsx\")` - reads in a excel sheet with 2022 MLB fielding statistics for all teams\n\n2022 statistics are from [here](https://www.baseball-reference.com/leagues/majors/2022.shtml).\n\n### Calculations\n\nThe [Bradley-Terry model](https://en.wikipedia.org/wiki/Bradley%E2%80%93Terry_model) is a probability model to predict outcomes of object i beating object j based on each objects ability or talent. In this instance, it is used to compare teams but it was originally to be used with players.\n\nTalent is calculated by z-scores of seasonal average run differential of each team and then divided by 10. The talents were divided by 10 to decrease variation between teams even more. It is then adjusted for home field advantage so 0.04, based on [this](https://sabr.org/journal/article/home-field-advantage/#:~:text=In%20every%20sport%20and%20at,percent%20of%20the%20games%20played.) article, is added to the probability of the home team winning.\n\nThe equation used in this project for probability is:\n\n```         \nprob.Home = exp(Talent.Home) / (exp(Talent.Home) + exp(Talent.Visitor)) + 0.04)\n```\n\nThen, that probability is plugged into another equation to calculate a winner from each game.\n\n```         \noutcome = rbinom(nrow(.), 1, prob.Home), winner = ifelse(outcome, Home, Visitor))\n```\n\nThis equation uses [rbinom](https://www.programmingr.com/examples/neat-tricks/sample-r-function/r-rbinom/) which simulates a series of Bernoulli trials and returns the results. This returns a 1 if the home team wins and a 0 if the visiting team wins.\n\n<!-- ::: callout-note -->\n<!-- This section is really good. Concise, clear, and a mostly complete set of information. I can't remember why you divide the talent Z scores by 10, so you should explain that. -->\n<!-- ::: -->\n\n\n::: {.cell}\n\n:::\n\n\n### One simulation\n\nOne season simulation with Wins and Losses from each team using the Bradley Terry model to predict each game.\n\n\n::: {.cell}\n::: {.cell-output-display}\n|        NL East        | Wins|Losses |       NL Cent       | Wins|Losses |       NL West        | Wins|Losses |\n|:---------------------:|----:|:------|:-------------------:|----:|:------|:--------------------:|----:|:------|\n|    Atlanta Braves     |   99|62     | St. Louis Cardinals |   95|66     | Los Angeles Dodgers  |   90|71     |\n|     New York Mets     |   87|74     |    Chicago Cubs     |   83|78     | San Francisco Giants |   90|71     |\n| Philadelphia Phillies |   80|81     |  Milwaukee Brewers  |   81|80     |   Colorado Rockies   |   81|80     |\n| Washington Nationals  |   77|84     |   Cincinnati Reds   |   72|89     |   San Diego Padres   |   80|81     |\n|     Miami Marlins     |   76|85     | Pittsburgh Pirates  |   62|99     | Arizona Diamondbacks |   72|89     |\n:::\n\n::: {.cell-output-display}\n|      AL East      | Wins|Losses |       AL Cent       | Wins|Losses |      AL West       | Wins|Losses |\n|:-----------------:|----:|:------|:-------------------:|----:|:------|:------------------:|----:|:------|\n| New York Yankees  |   91|71     | Cleveland Guardians |   88|74     |   Texas Rangers    |   90|72     |\n| Toronto Blue Jays |   85|77     |   Minnesota Twins   |   88|74     |   Houston Astros   |   86|76     |\n|  Boston Red Sox   |   74|88     |  Chicago White Sox  |   84|78     | Los Angeles Angels |   82|80     |\n|  Tampa Bay Rays   |   72|90     |   Detroit Tigers    |   81|81     | Oakland Athletics  |   76|86     |\n| Baltimore Orioles |   69|93     | Kansas City Royals  |   67|95     |  Seattle Mariners  |   72|90     |\n:::\n:::\n\n\n### 1000 Season Simulations\n\n\n::: {.cell}\n\n:::\n\n\n#### Playoff Percentage\n\nHere is the percentage of seasons in 1000 simulations where each team made the playoffs.\n\n\n::: {.cell}\n::: {.cell-output-display}\n|NL East               | Playoff % |NL Cent             | Playoff % |NL West              | Playoff % |\n|:---------------------|:---------:|:-------------------|:---------:|:--------------------|:---------:|\n|Atlanta Braves        |   71.7%   |St. Louis Cardinals |   68.7%   |Los Angeles Dodgers  |   89.6%   |\n|New York Mets         |   66.3%   |Milwaukee Brewers   |   46.4%   |San Francisco Giants |   48.4%   |\n|Philadelphia Phillies |   47.1%   |Chicago Cubs        |   28.3%   |San Diego Padres     |   42.7%   |\n|Miami Marlins         |   21.4%   |Cincinnati Reds     |   16.4%   |Arizona Diamondbacks |   28.3%   |\n|Washington Nationals  |   5.5%    |Pittsburgh Pirates  |   8.0%    |Colorado Rockies     |   11.2%   |\n:::\n\n::: {.cell-output-display}\n|AL East           | Playoff % |AL Cent             | Playoff % |AL West            | Playoff % |\n|:-----------------|:---------:|:-------------------|:---------:|:------------------|:---------:|\n|New York Yankees  |   77.1%   |Cleveland Guardians |   53.2%   |Houston Astros     |   76.9%   |\n|Toronto Blue Jays |   50.4%   |Minnesota Twins     |   45.3%   |Seattle Mariners   |   43.3%   |\n|Tampa Bay Rays    |   47.8%   |Chicago White Sox   |   36.7%   |Los Angeles Angels |   30.8%   |\n|Baltimore Orioles |   35.3%   |Detroit Tigers      |   17.9%   |Texas Rangers      |   30.4%   |\n|Boston Red Sox    |   28.6%   |Kansas City Royals  |   15.5%   |Oakland Athletics  |   10.8%   |\n:::\n:::\n\n\n#### Win Percentage\n\nHere is the percentage of wins each team had after 1000 seasons\n\n\n::: {.cell}\n::: {.cell-output-display}\n|NL East               | Win % |NL Cent             | Win % |NL West              | Win % |\n|:---------------------|:-----:|:-------------------|:-----:|:--------------------|:-----:|\n|Atlanta Braves        | 53.5% |St. Louis Cardinals | 52.8% |Los Angeles Dodgers  | 56.0% |\n|New York Mets         | 53.0% |Milwaukee Brewers   | 50.8% |San Francisco Giants | 51.1% |\n|Philadelphia Phillies | 51.1% |Chicago Cubs        | 48.9% |San Diego Padres     | 50.8% |\n|Miami Marlins         | 48.3% |Cincinnati Reds     | 47.2% |Arizona Diamondbacks | 49.1% |\n|Washington Nationals  | 45.4% |Pittsburgh Pirates  | 45.9% |Colorado Rockies     | 46.5% |\n:::\n\n::: {.cell-output-display}\n|AL East           | Win % |AL Cent             | Win % |AL West            | Win % |\n|:-----------------|:-----:|:-------------------|:-----:|:------------------|:-----:|\n|New York Yankees  | 54.2% |Cleveland Guardians | 51.3% |Houston Astros     | 53.9% |\n|Toronto Blue Jays | 51.3% |Minnesota Twins     | 50.3% |Seattle Mariners   | 50.6% |\n|Tampa Bay Rays    | 50.9% |Chicago White Sox   | 49.6% |Los Angeles Angels | 49.2% |\n|Baltimore Orioles | 49.6% |Detroit Tigers      | 47.4% |Texas Rangers      | 49.2% |\n|Boston Red Sox    | 48.8% |Kansas City Royals  | 46.9% |Oakland Athletics  | 46.3% |\n:::\n:::\n\n\n### 2023 Season Actual Statistics\n\nHere are the current standings and win percentages of each team in the MLB as of Sept 6th\n\n<!-- ::: callout-note -->\n<!-- Looking good. We should update this for current data. In a lot of the preceding code and the following chunk you are taking a pretty blunt approach to setting up your data frames. We should change this so that your tables can be dynamically updated. -->\n<!-- ::: -->\n\n\n::: {.cell}\n::: {.cell-output-display}\n|NL East               |Win % |NL Cent             |Win % |NL West              |Win % |\n|:---------------------|:-----|:-------------------|:-----|:--------------------|:-----|\n|Atlanta Braves        |65.5% |Milwaukee Brewers   |55.4% |Los Angeles Dodgers  |61.2% |\n|Philadelphia Phillies |55.4% |Chicago Cubs        |53.9% |Arizona Diamondbacks |51.8% |\n|Miami Marlins         |51.4% |Cincinnati Reds     |51.4% |San Francisco Giants |50%   |\n|New York Mets         |46%   |Pittsburgh Pirates  |46.4% |San Diego Padres     |46.8% |\n|Washington Nationals  |45%   |St. Louis Cardinals |43.6% |Colorado Rockies     |36.7% |\n:::\n\n::: {.cell-output-display}\n|AL East           |Win % |AL Cent             |Win % |AL West            |Win % |\n|:-----------------|:-----|:-------------------|:-----|:------------------|:-----|\n|Baltimore Orioles |63.3% |Minnesota Twins     |52.1% |Houston Astros     |56.7% |\n|Tampa Bay Rays    |60.3% |Cleveland Guardians |47.9% |Seattle Mariners   |56.4% |\n|Toronto Blue Jays |55%   |Detroit Tigers      |45.7% |Texas Rangers      |54.7% |\n|Boston Red Sox    |51.4% |Chicago White Sox   |38.6% |Los Angeles Angels |45.7% |\n|New York Yankees  |50%   |Kansas City Royals  |31.2% |Oakland Athletics  |36.5% |\n:::\n:::\n\n\n### Comparison of Projected and Actual Statistics\n\nHere are the projected winning percentage and the actual winning percentage side by side\n\n<!-- ::: callout-note -->\n<!-- I love the figures. You do need a concluding statement. How well is your model performing? Which teams did it not predict well? Any theories as to why? It would be great if we could add a visual encoding for teams that over or under performed. -->\n<!-- ::: -->\n\n\n::: {.cell}\n::: {.cell-output-display}\n|NL East               | Actual Win % | Projected Win % |NL Cent             | Actual Win % | Projected Win % |NL West              | Actual Win % | Projected Win % |\n|:---------------------|:------------:|:---------------:|:-------------------|:------------:|:---------------:|:--------------------|:------------:|:---------------:|\n|Atlanta Braves        |    65.5%     |      53.5%      |Milwaukee Brewers   |    55.4%     |      48.9%      |Los Angeles Dodgers  |    61.2%     |      49.1%      |\n|Philadelphia Phillies |    55.4%     |      48.3%      |Chicago Cubs        |    53.9%     |      47.2%      |Arizona Diamondbacks |    51.8%     |      46.5%      |\n|Miami Marlins         |    51.4%     |      53.0%      |Cincinnati Reds     |    51.4%     |      50.8%      |San Francisco Giants |     50%      |      56.0%      |\n|New York Mets         |     46%      |      51.1%      |Pittsburgh Pirates  |    46.4%     |      45.9%      |San Diego Padres     |    46.8%     |      50.8%      |\n|Washington Nationals  |     45%      |      45.4%      |St. Louis Cardinals |    43.6%     |      52.8%      |Colorado Rockies     |    36.7%     |      51.1%      |\n:::\n\n::: {.cell-output-display}\n|AL East           | Actual Win % | Projected Win % |AL Cent             | Actual Win % | Projected Win % |AL West            | Actual Win % | Projected Win % |\n|:-----------------|:------------:|:---------------:|:-------------------|:------------:|:---------------:|:------------------|:------------:|:---------------:|\n|Baltimore Orioles |    63.3%     |      49.6%      |Minnesota Twins     |    52.1%     |      49.6%      |Houston Astros     |    56.7%     |      53.9%      |\n|Tampa Bay Rays    |    60.3%     |      48.8%      |Cleveland Guardians |    47.9%     |      51.3%      |Seattle Mariners   |    56.4%     |      49.2%      |\n|Toronto Blue Jays |     55%      |      54.2%      |Detroit Tigers      |    45.7%     |      47.4%      |Texas Rangers      |    54.7%     |      46.3%      |\n|Boston Red Sox    |    51.4%     |      50.9%      |Chicago White Sox   |    38.6%     |      46.9%      |Los Angeles Angels |    45.7%     |      50.6%      |\n|New York Yankees  |     50%      |      51.3%      |Kansas City Royals  |    31.2%     |      50.3%      |Oakland Athletics  |    36.5%     |      49.2%      |\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\nBased on the graphs above, the model did the best job of estimating win percentages of teams that had winning percentages of about 50%. It did not do a good job of estimating teams that have won or lost a lot more games than last year. This is understandable because these teams are either scoring a lot more or less runs than last season which is what the winning percentages were based on. \n\n\n### Links to resources used\n\n[How FiveThirtyEight does their predictions](https://fivethirtyeight.com/features/how-our-mlb-predictions-work/)\n\n[Playoff Simulator](https://playoffpredictors.com/Baseball?L=Aw18ZXTt-DFOS1b0c17Pd-wYUcSaWeRZVdTbXfQ408y6xQEwCMw7wn7Azvy6CuQ4QLHD+QqZMkyxI+VPEy1I6UtnilowVp3KFE3etOztpqzq2rFB9XN1Xjh88flnH+h06+Wii6WyiESns4qXgoGAYHSZua2blEa9h4ebi7OGgmGomqF4XklTmFpiY5hkRkOoQVV+rHRVRXJKu7BJkFZ1SFNRd2teq3JpWNVPHKaSQkdMz2aNrNZJqOhifEBC4E+Q8F2xTGpMeEDFSfcuctrS0bzm3W9RrkHhafWC8eucz92jUI+BtohZfGDrHkAUtpp1topEEA)\n\n[Simulator in R](https://baseballwithr.wordpress.com/2020/06/29/simulating-a-60-game-season/)\n\n[2022 Updated Playoffs](https://www.sportingnews.com/us/mlb/news/mlb-expanded-playoffs-postseason-2022-teams/sayv4pysmmlopks7hg2o2lbv)\n\n[Home Field Advantage](https://sabr.org/journal/article/home-field-advantage/#:~:text=In%20every%20sport%20and%20at,percent%20of%20the%20games%20played.)\n\n[Contributing Factors in Increasing Winning Percentage](https://digitalcommons.bryant.edu/cgi/viewcontent.cgi?article=1021&context=honors_finance#:~:text=Potential%20factors%20that%20affect%20winning,home%20runs%2C%20runs%20batted%20in)\n\n[2022 Stats](https://www.baseball-reference.com/leagues/majors/2022.shtml)\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}